# -*- coding: utf-8 -*-

from androguard.core.bytecodes.apk import APK
from androguard.session import Session
from androguard.core.bytecodes.dvm import DalvikVMFormat
#from androguard.core.bytecodes.dvm import ClassDataItem
from androguard.misc import AnalyzeAPK
from androguard.core.analysis.analysis import ExternalMethod, StringAnalysis
import hashlib
import os
import PERMISSIONS_RULE_kor #PERMISSONS
#from apk import APK

os.chdir('C:/Users/SCHCSRC/Desktop/Work/VSC/androguard')
apkf = APK('1.apk')


print ('1. App Name')
print(apkf.get_app_name())

print ('\n2. Package')
print(apkf.get_package())

print ('\n3. Permissions')
Perm = apkf.get_permissions()



for i in Perm:
    Perm_list = i.replace("android.permission.","")
    MAN_PERM = PERMISSIONS_RULE_kor.DVM_PERMISSIONS['MANIFEST_PERMISSION'][Perm_list]
    print(i,' :',MAN_PERM)
#classes = apkf.get_dex()
#print('\n8. String')
#print("=====DEX=====")
#a = DalvikVMFormat(classes)

#with open('text.txt','w',encoding='utf-8') as f:
#    data = f.write(a.get_strings())

#print(a.get_strings())

#for i in Perm:
#    i = i.replace("android.permission.","")
#    print(i ,':', PERMISSIONS_RULE.DVM_PERMISSIONS['MANIFEST_PERMISSION'][i])